#!/bin/zsh
#
# Appends all git versions of a file to an output file.
# Useful for collecting historical versions of a file across commits.

file_name=$1
output_file=$2

if [[ -z "$file_name" || -z "$output_file" ]]; then
  echo "Usage: append_git_versions <file_name> <output_file>"
  exit 1
fi

if ! git ls-files --error-unmatch "$file_name" > /dev/null 2>&1; then
  echo "Error: $file_name is not tracked by git."
  exit 1
fi

file_commits=$(git log --pretty=format:%H -- "$file_name")

for commit in $file_commits; do
  git checkout $commit
  cat $file_name >> $output_file
done

git checkout master

echo "All versions of $file_name have been appended to $output_file."
