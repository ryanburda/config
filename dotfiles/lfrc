# Basic Settings
set drawbox true
set icons true
set ignorecase true
set scrolloff 4

# Custom Functions
# define a custom 'open' command
# This command is called when current file is not a directory. You may want to
# use either file extensions and/or mime types here. Below uses an editor for
# text files and a file opener for the rest.
cmd open &{{
    case $(file --mime-type -Lb $f) in
        text/*) lf -remote "send $id \$$EDITOR \$fx";;
        *) for f in $fx; do $OPENER $f > /dev/null 2> /dev/null & done;;
    esac
}}

cmd open_nvim &{{
    %set -f
    if [[ -n $TMUX ]]; then
        NVIM_PIPE=$(tmux show-environment NVIM_PIPE 2> /dev/null | awk -F '=' '{print $2}');
        if [[ $? == 0 ]]; then
            nvim --server $NVIM_PIPE --remote $f
        fi
    else
        nvim $f
    fi
}}

cmd create %printf "Create File/Dirctory: "; read ans; mkdir $(dirname $ans); touch $ans

# define a custom 'rename' command without prompt for overwrite
cmd rename %[ -e $1 ] && printf "file exists" || mv $f $1

# extract the current file with the right command
# (xkcd link: https://xkcd.com/1168/)
cmd extract ${{
    set -f
    case $f in
        *.tar.bz|*.tar.bz2|*.tbz|*.tbz2) tar xjvf $f;;
        *.tar.gz|*.tgz) tar xzvf $f;;
        *.tar.xz|*.txz) tar xJvf $f;;
        *.zip) unzip $f;;
        *.rar) unrar x $f;;
        *.7z) 7z x $f;;
    esac
}}

# compress current file or selected files with tar and gunzip
cmd tar ${{
    set -f
    mkdir $1
    cp -r $fx $1
    tar czf $1.tar.gz $1
    rm -rf $1
}}

# compress current file or selected files with zip
cmd zip ${{
    set -f
    mkdir $1
    cp -r $fx $1
    zip -r $1.zip $1
    rm -rf $1
}}

# trash bindings
$mkdir -p ~/.trash
cmd trash %set -f; mv $fx ~/.trash

# Bindings
# Remove some defaults
map m
map o
map n
map "'"
map '"'
map d

# Basic Functions
map . set hidden!
map dd trash
map p paste
map x cut
map y copy
map r push :rename<space>
map <enter> open
map o open_nvim
map R reload
map a create
map C clear
map ce extract
map ct tar
map cz zip

# Movement
map g/ cd /
map ga cd ~/
map gs cd ~/Downloads
map gd cd ~/Desktop
