#!/bin/zsh
#
# NAME
#   font_picker - changes font in alacritty.
#
# SYNOPSIS
#   font_picker
#
# DESCRIPTION
#   Use fzf to select a font. The font is then substituted into alacritty.yml.
#   This is a separate command from the more generic `set_font` command so that
#   only a specific set of fonts show up in the font picker.
fonts=(
    "FiraCode Nerd Font Mono,11"
    "GohuFont 14 Nerd Font Mono,12"
    "Hack Nerd Font Mono,11"
    "JetBrainsMono Nerd Font Mono,11"
    "Liga SFMono Nerd Font,11"
    "SauceCodePro Nerd Font Mono,11"
)

current_font=$(<$XDG_CONFIG_HOME/alacritty/.font)
current_font_size=$(<$XDG_CONFIG_HOME/alacritty/.font_size)

# TODO: figure out why full path to `set_font` needs to be specified
selection=$(printf "%s\n" "${fonts[@]}" | sort -r | fzf --cycle --bind "focus:execute-silent(IFS=',' read -r font size <<< {}; ~/.zsh/funcs/set_font \"\$font\" \"\$size\")")
if [[ -z "${selection}" ]]; then
    # reset font if nothing selected
    ~/.zsh/funcs/set_font $current_font $current_font_size
    return 0
fi
