# This script expects two arguments:
#   * the name of an installed font. (ex. "Hack Nerd Font Mono")
#   * a size for that font. (ex. 12)
font=$1
font_size=$2

# Before updating the alacritty.yml we first need to get the current theme.
# The template does not contain any information about themes so we will use
# the following variable to reapply the current theme after the the yml is
# recreated off the template.
theme=$(alacritty-themes --current | head -n 1)

# Write the font selection to a file to better handle cases where the envvar is not set.
echo $font > $XDG_CONFIG_HOME/alacritty/.font
echo $font_size > $XDG_CONFIG_HOME/alacritty/.font_size

# Fill in the font name in the template to create a new alacritty.yml file.
export ALACRITTY_FONT=$font
export ALACRITTY_FONT_SIZE=$font_size
envsubst < "${XDG_CONFIG_HOME}/alacritty/alacritty.yml.template" > "${XDG_CONFIG_HOME}/alacritty/alacritty.yml"

# Reapply the color theme.
alacritty-themes $theme > /dev/null
# remove the annoying backup files created by alacritty-themes
rm $XDG_CONFIG_HOME/alacritty/alacritty.yml.*.bak
